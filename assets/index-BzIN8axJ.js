import{r as c,b as P}from"./index-IQZlS5KY.js";import{u as O,a as A}from"./index-C4LMBIUZ.js";import{u as R}from"./index-DQSDpuZ0.js";function I(e,n,{checkForDefaultPrevented:r=!0}={}){return function(o){if(e==null||e(o),r===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}function y({prop:e,defaultProp:n,onChange:r=()=>{}}){const[t,o]=g({defaultProp:n,onChange:r}),i=e!==void 0,d=i?e:t,f=O(r),u=c.useCallback(s=>{if(i){const a=typeof s=="function"?s(e):s;a!==e&&f(a)}else o(s)},[i,e,o,f]);return[d,u]}function g({defaultProp:e,onChange:n}){const r=c.useState(e),[t]=r,o=c.useRef(t),i=O(n);return c.useEffect(()=>{o.current!==t&&(i(t),o.current=t)},[t,o,i]),r}function h(e,n){return c.useReducer((r,t)=>n[r][t]??r,e)}var S=e=>{const{present:n,children:r}=e,t=M(n),o=typeof r=="function"?r({present:t.isPresent}):c.Children.only(r),i=R(t.ref,T(o));return typeof r=="function"||t.isPresent?c.cloneElement(o,{ref:i}):null};S.displayName="Presence";function M(e){const[n,r]=c.useState(),t=c.useRef({}),o=c.useRef(e),i=c.useRef("none"),d=e?"mounted":"unmounted",[f,u]=h(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const s=N(t.current);i.current=f==="mounted"?s:"none"},[f]),A(()=>{const s=t.current,m=o.current;if(m!==e){const p=i.current,l=N(s);e?u("MOUNT"):l==="none"||(s==null?void 0:s.display)==="none"?u("UNMOUNT"):u(m&&p!==l?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),A(()=>{if(n){const s=a=>{const l=N(t.current).includes(a.animationName);a.target===n&&l&&P.flushSync(()=>u("ANIMATION_END"))},m=a=>{a.target===n&&(i.current=N(t.current))};return n.addEventListener("animationstart",m),n.addEventListener("animationcancel",s),n.addEventListener("animationend",s),()=>{n.removeEventListener("animationstart",m),n.removeEventListener("animationcancel",s),n.removeEventListener("animationend",s)}}else u("ANIMATION_END")},[n,u]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:c.useCallback(s=>{s&&(t.current=getComputedStyle(s)),r(s)},[])}}function N(e){return(e==null?void 0:e.animationName)||"none"}function T(e){var t,o;let n=(t=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:t.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?e.ref:(n=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}export{S as P,I as c,y as u};
